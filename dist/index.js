!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["vuex-orm-axios"]=e():t["vuex-orm-axios"]=e()}(global,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([function(t,e){t.exports=require("@babel/runtime/regenerator")},function(t,e){t.exports=require("@babel/runtime/helpers/classCallCheck")},function(t,e){t.exports=require("@babel/runtime/helpers/createClass")},function(t,e){t.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(t,e){t.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(t,e){t.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(t,e){t.exports=require("@babel/runtime/helpers/inherits")},function(t,e){t.exports=require("lodash/merge")},function(t,e){t.exports=require("@babel/runtime/helpers/typeof")},function(t,e){t.exports=require("lodash/map")},function(t,e){t.exports=require("lodash/find")},function(t,e){t.exports=require("@vuex-orm/core")},function(t,e){t.exports=require("lodash/forEach")},function(t,e){t.exports=require("lodash/has")},function(t,e){t.exports=require("axios")},function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),a=n(2),u=n.n(a),i=n(9),s=n.n(i),c=n(7),l=n.n(c),p=n(10),d=n.n(p),h={axios:void 0,baseURL:"http://localhost:3000",url:"/",method:"get",access_token:"",headers:{"Content-Type":"application/json",Accept:"application/json"},data:{},timeout:0,withCredentials:!1,responseType:"json",responseEncoding:"utf8",validateStatus:function(t){return t>=200&&t<300},maxRedirects:5,socketPath:null,proxy:{},onResponse:function(t){return t.data},onUnauthorised:function(t){},onNotFound:function(t){},onServerError:function(t){},onGenericError:function(t){},onValidationError:function(t){},onError:function(t){var e=t.response,n={401:this.onUnauthorised,404:this.onNotFound,422:this.onValidationError,500:this.onServerError};return e&&e.status in n?n[e.status](t):this.onGenericError(t),Promise.reject(t)}},f={database:new(n(11).Database),http:h},m={getters:{loading:function(t){return t.loading},errors:function(t){return t.errors}},mutations:{onRequest:function(t){t.loading=!0,t.errors=[]},onError:function(t,e){t.loading=!1,t.errors=e.data},onSuccess:function(t){t.loading=!1,t.errors=[]}},state:{loading:!1,errors:[]}},v={http:h,methods:{$fetch:{name:"fetch",http:{url:"",method:"get"}},$get:{name:"get",http:{url:"/:id",method:"get"}},$create:{name:"create",alias:["insert"],http:{url:"",method:"post"}},$update:{name:"update",http:{url:"/:id",method:"put"}},$delete:{name:"delete",http:{url:"/:id",method:"delete"}}}},g=function(){function t(e,n){if(o()(this,t),this.components=e,this.options=l()({},f,n),this.database=n.database,!n.database)throw new Error("database option is required to initialise!")}return u()(t,[{key:"getModelFromState",value:function(t){return d()(this.database.entities,{name:t.$name}).model}}],[{key:"setup",value:function(e,n){return this.instance=new t(e,n),this.instance}},{key:"getInstance",value:function(){return this.instance}}]),t}(),y=n(12),b=n.n(y),k=n(13),x=n.n(k),$=function(){function t(){o()(this,t)}return u()(t,null,[{key:"transformModule",value:function(t){return l()({},m,t)}},{key:"transformModel",value:function(t){var e=g.getInstance();return v.http=l()({},v.http,e.options.http),t.methodConf=l()({},v,t.methodConf),t.methodConf.http.url="/"===t.methodConf.http.url?"/".concat(t.entity):t.methodConf.http.url,t.getFields=function(){return t.cachedFields||(t.cachedFields=l()({},{$id:t.attr(void 0),$isUpdating:t.boolean(!1),$updateErrors:t.attr([]),$isDeleting:t.boolean(!1),$deleteErrors:t.attr([])},t.fields())),t.cachedFields},t}},{key:"transformParams",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="".concat(e.methodConf.http.url).concat(e.methodConf.methods[t].http.url),o=s()(r.match(/(\/?)(\:)([A-z]*)/gm),function(t){return t.replace("/","")});return b()(o,function(t){var e=x()(n.params,t.replace(":",""))?n.params[t.replace(":","")]:"";r=r.replace(t,e).replace("//","/")}),n.query&&(r+="?".concat(Object.keys(n.query).map(function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n.query[t]))}).join("&"))),r}},{key:"getMethod",value:function(t,e,n){var r=e.methodConf.methods[t].http.method;return r||n}}]),t}(),w=n(0),q=n.n(w),E=n(3),S=n.n(E),M=n(4),C=n.n(M),R=n(5),j=n.n(R),P=n(6),O=n.n(P),A=n(8),F=n.n(A),U=n(14),I=n.n(U),T=function(){function t(e){var n=this;return o()(this,t),this.instance=e.axios||I.a.create(e),this.setAuthentication(e.access_token),this.instance.interceptors.response.use(function(t){return e.onResponse(t,n.instance)},function(t){return e.onError(t,n.instance)}),this.instance}return u()(t,[{key:"setAuthentication",value:function(t){if(t){var e=F()(t)?t():t;this.instance.defaults.headers.common.Authorization="Bearer ".concat(e)}}},{key:"head",value:function(){var t=S()(q.a.mark(function t(e){var n,r=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},t.abrupt("return",this.instance.head(e,n));case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=S()(q.a.mark(function t(e){var n,r=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},t.abrupt("return",this.instance.get(e,n));case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"post",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",this.instance.post(e,n,r));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"patch",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",this.instance.patch(e,n,r));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"put",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",this.instance.put(e,n,r));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"delete",value:function(){var t=S()(q.a.mark(function t(e){var n,r=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},t.abrupt("return",this.instance.delete(e,n));case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),t}(),_=function(t){function e(){return o()(this,e),C()(this,j()(e).apply(this,arguments))}return O()(e,t),u()(e,null,[{key:"call",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o,a,u,i,s,c,l,p=this,d=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,r=e.commit,o=d.length>1&&void 0!==d[1]?d[1]:{},a=g.getInstance(),u=a.getModelFromState(n),i=$.transformParams("$fetch",u,o),s=new T(u.methodConf.http),c=$.getMethod("$fetch",u,"get"),l=s[c](i),this.onRequest(r),l.then(function(t){return p.onSuccess(r,u,t)}).catch(function(t){return p.onError(r,t)}),t.abrupt("return",l);case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onRequest",value:function(t){t("onRequest")}},{key:"onSuccess",value:function(t,e,n){t("onSuccess"),e.insertOrUpdate({data:n})}},{key:"onError",value:function(t,e){t("onError",e)}}]),e}($),D=function(t){function e(){return o()(this,e),C()(this,j()(e).apply(this,arguments))}return O()(e,t),u()(e,null,[{key:"call",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o,a,u,i,s,c,l,p=this,d=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,r=e.commit,o=d.length>1&&void 0!==d[1]?d[1]:{},a=g.getInstance(),u=a.getModelFromState(n),i=$.transformParams("$get",u,o),s=new T(u.methodConf.http),c=$.getMethod("$get",u,"get"),l=s[c](i),this.onRequest(r),l.then(function(t){return p.onSuccess(r,u,t)}).catch(function(t){return p.onError(r,t)}),t.abrupt("return",l);case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onRequest",value:function(t){t("onRequest")}},{key:"onSuccess",value:function(t,e,n){t("onSuccess"),e.insertOrUpdate({data:n})}},{key:"onError",value:function(t,e){t("onError",e)}}]),e}($),G=function(t){function e(){return o()(this,e),C()(this,j()(e).apply(this,arguments))}return O()(e,t),u()(e,null,[{key:"call",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o,a,u,i,s,c,l,p=this,d=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state,r=e.commit,(o=d.length>1&&void 0!==d[1]?d[1]:{}).data&&"object"===F()(o)){t.next=4;break}throw new TypeError("You must include a data object in the params to send a POST request",o);case 4:return a=g.getInstance(),u=a.getModelFromState(n),i=$.transformParams("$create",u,o),s=new T(u.methodConf.http),c=$.getMethod("$create",u,"post"),l=s[c](i,o.data),this.onRequest(r),l.then(function(t){return p.onSuccess(r,u,t)}).catch(function(t){return p.onError(r,t)}),t.abrupt("return",l);case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onRequest",value:function(t){t("onRequest")}},{key:"onSuccess",value:function(t,e,n){t("onSuccess"),e.insertOrUpdate({data:n})}},{key:"onError",value:function(t,e){t("onError",e)}}]),e}($),z=function(t){function e(){return o()(this,e),C()(this,j()(e).apply(this,arguments))}return O()(e,t),u()(e,null,[{key:"call",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o,a,u,i,s,c,l=this,p=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state,e.commit,(r=p.length>1&&void 0!==p[1]?p[1]:{}).data&&"object"===F()(r)){t.next=4;break}throw new TypeError("You must include a data object in the params to send a POST request",r);case 4:return o=g.getInstance(),a=o.getModelFromState(n),u=$.transformParams("$update",a,r),i=new T(a.methodConf.http),s=$.getMethod("$update",a,"put"),c=i[s](u,r.data),this.onRequest(a,r),c.then(function(t){return l.onSuccess(a,r,t)}).catch(function(t){return l.onError(a,r,t)}),t.abrupt("return",c);case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onRequest",value:function(t,e){t.update({where:e.params.id,data:{$isUpdating:!0,$updateErrors:[]}})}},{key:"onSuccess",value:function(t,e,n){t.update({where:e.params.id||n.id,data:l()({},n,{$isUpdating:!1,$updateErrors:[]})})}},{key:"onError",value:function(t,e,n){t.update({where:e.params.id,data:{$isUpdating:!1,$updateErrors:n}})}}]),e}($),N=function(t){function e(){return o()(this,e),C()(this,j()(e).apply(this,arguments))}return O()(e,t),u()(e,null,[{key:"call",value:function(){var t=S()(q.a.mark(function t(e){var n,r,o,a,u,i,s,c,l=this,p=arguments;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,e.commit,r=p.length>1&&void 0!==p[1]?p[1]:{},o=g.getInstance(),a=o.getModelFromState(n),u=$.transformParams("$delete",a,r),i=new T(a.methodConf.http),s=$.getMethod("$delete",a,"delete"),c=i[s](u),this.onRequest(a,r),c.then(function(t){return l.onSuccess(a,r,t)}).catch(function(t){return l.onError(a,r,t)}),t.abrupt("return",c);case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onRequest",value:function(t,e){t.update({where:e.params.id,data:{$isDeleting:!0,$deleteErrors:[]}})}},{key:"onSuccess",value:function(t,e,n){t.delete({where:e.params.id||n.id})}},{key:"onError",value:function(t,e,n){t.update({where:e.params.id,data:{$isDeleting:!1,$deleteErrors:n}})}}]),e}($),V=function(){function t(e,n){o()(this,t),g.setup(e,n),this.setupActions(),this.setupModels()}return u()(t,[{key:"setupActions",value:function(){var t=g.getInstance();t.components.Actions.$fetch=_.call.bind(_),t.components.Actions.$get=D.call.bind(D),t.components.Actions.$create=G.call.bind(G),t.components.Actions.$update=z.call.bind(z),t.components.Actions.$delete=N.call.bind(N)}},{key:"setupModels",value:function(){var t=g.getInstance();s()(t.database.entities,function(t){return t.module=$.transformModule(t.module),t.model=$.transformModel(t.model),t}),t.components.Model.$fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$fetch",t)},t.components.Model.$get=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$get",t)},t.components.Model.$create=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$create",t)},t.components.Model.$update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$update",t)},t.components.Model.$delete=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$delete",t)}}}]),t}();n.d(e,"default",function(){return Y});var Y=function(){function t(){o()(this,t)}return u()(t,null,[{key:"install",value:function(t,e){return new V(t,e)}}]),t}()}])});