!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["vuex-orm-axios"]=e():t["vuex-orm-axios"]=e()}(global,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([function(t,e){t.exports=require("@babel/runtime/regenerator")},function(t,e){t.exports=require("@babel/runtime/helpers/classCallCheck")},function(t,e){t.exports=require("@babel/runtime/helpers/createClass")},function(t,e){t.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(t,e){t.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(t,e){t.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(t,e){t.exports=require("@babel/runtime/helpers/inherits")},function(t,e){t.exports=require("lodash-es/merge")},function(t,e){t.exports=require("lodash-es/map")},function(t,e){t.exports=require("@babel/runtime/helpers/typeof")},function(t,e){t.exports=require("lodash-es/find")},function(t,e){t.exports=require("@vuex-orm/core")},function(t,e){t.exports=require("lodash-es/forEach")},function(t,e){t.exports=require("lodash-es/has")},function(t,e){t.exports=require("axios")},function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),a=n(2),s=n.n(a),u=n(8),i=n.n(u),c=n(7),l=n.n(c),p=n(10),d=n.n(p),h={axios:void 0,baseURL:"http://localhost:3000",url:"/",method:"get",access_token:"",headers:{"Content-Type":"application/json",Accept:"application/json"},data:{},timeout:0,withCredentials:!1,responseType:"json",responseEncoding:"utf8",validateStatus:function(t){return t>=200&&t<300},maxRedirects:5,socketPath:null,proxy:{},onRequest:function(t,e){return t},onResponse:function(t,e){return t.data},onUnauthorised:function(t){},onNotFound:function(t){},onServerError:function(t){},onGenericError:function(t){},onValidationError:function(t){},onError:function(t,e){var n=t.response,r={401:this.onUnauthorised,404:this.onNotFound,422:this.onValidationError,500:this.onServerError};return n&&n.status in r?r[n.status](t):this.onGenericError(t),Promise.reject(t)}},f={database:new(n(11).Database),http:h},m={getters:{loading:function(t){return t.loading},errors:function(t){return t.errors}},mutations:{onRequest:function(t){t.loading=!0,t.errors=[]},onError:function(t,e){t.loading=!1,t.errors=e.data},onSuccess:function(t){t.loading=!1,t.errors=[]}},state:{loading:!1,errors:[]}},v={http:h,methods:{$fetch:{name:"fetch",http:{url:"",method:"get"}},$get:{name:"get",http:{url:"/:id",method:"get"}},$create:{name:"create",alias:["insert"],http:{url:"",method:"post"}},$update:{name:"update",http:{url:"/:id",method:"put"}},$delete:{name:"delete",http:{url:"/:id",method:"delete"}}}},y=function(){function t(e,n){if(o()(this,t),this.components=e,this.options=l()({},f,n),this.database=n.database,!n.database)throw new Error("database option is required to initialise!")}return s()(t,[{key:"getModelFromState",value:function(t){return d()(this.database.entities,{name:t.$name}).model}}],[{key:"setup",value:function(e,n){return this.instance=new t(e,n),this.instance}},{key:"getInstance",value:function(){return this.instance}}]),t}(),g=n(12),b=n.n(g),x=n(13),k=n.n(x),$=function(){function t(){o()(this,t)}return s()(t,null,[{key:"transformModule",value:function(t){return l()({},m,t)}},{key:"transformModel",value:function(t){var e=y.getInstance();return v.http=l()({},v.http,e.options.http),t.methodConf=l()({},v,t.methodConf),t.methodConf.http.url="/"===t.methodConf.http.url?"/".concat(t.entity):t.methodConf.http.url,t.getFields=function(){return t.cachedFields||(t.cachedFields=l()({},{$id:t.attr(void 0),$isUpdating:t.boolean(!1),$updateErrors:t.attr([]),$isDeleting:t.boolean(!1),$deleteErrors:t.attr([])},t.fields())),t.cachedFields},t}},{key:"transformParams",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="".concat(e.methodConf.http.url).concat(e.methodConf.methods[t].http.url),o=i()(r.match(/(\/?)(\:)([A-z]*)/gm),(function(t){return t.replace("/","")}));return b()(o,(function(t){var e=k()(n.params,t.replace(":",""))?n.params[t.replace(":","")]:"";r=r.replace(t,e).replace("//","/")})),n.query&&(r+="?".concat(Object.keys(n.query).map((function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n.query[t]))})).join("&"))),r}},{key:"getMethod",value:function(t,e,n){var r=e.methodConf.methods[t].http.method;return r||n}}]),t}(),w=n(0),q=n.n(w),E=n(3),S=n.n(E),M=n(4),R=n.n(M),C=n(5),j=n.n(C),P=n(6),O=n.n(P),A=n(14),F=n.n(A),U=function(){function t(e){var n=this;return o()(this,t),this.instance=e.axios||F.a.create(e),this.setAuthentication(e.access_token),this.instance.interceptors.request.use((function(t){return e.onRequest(t,n.instance)}),(function(t){return e.onError(t,n.instance)})),this.instance.interceptors.response.use((function(t){return e.onResponse(t,n.instance)}),(function(t){return e.onError(t,n.instance)})),this.instance}var e,n,r,a,u,i;return s()(t,[{key:"setAuthentication",value:function(t){if(t){var e="function"==typeof t?t():t;this.instance.defaults.headers.common.Authorization="Bearer ".concat(e)}}},{key:"head",value:(i=S()(q.a.mark((function t(e){var n,r=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},t.abrupt("return",this.instance.head(e,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"get",value:(u=S()(q.a.mark((function t(e){var n,r=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},t.abrupt("return",this.instance.get(e,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"post",value:(a=S()(q.a.mark((function t(e){var n,r,o=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",this.instance.post(e,n,r));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"patch",value:(r=S()(q.a.mark((function t(e){var n,r,o=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",this.instance.patch(e,n,r));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"put",value:(n=S()(q.a.mark((function t(e){var n,r,o=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",this.instance.put(e,n,r));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"delete",value:(e=S()(q.a.mark((function t(e){var n,r=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},t.abrupt("return",this.instance.delete(e,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),I=function(t){function e(){return o()(this,e),R()(this,j()(e).apply(this,arguments))}var n;return O()(e,t),s()(e,null,[{key:"call",value:(n=S()(q.a.mark((function t(e){var n,r,o,a,s,u,i,c,l,p=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,r=e.commit,o=p.length>1&&void 0!==p[1]?p[1]:{},a=y.getInstance(),s=a.getModelFromState(n),u=$.transformParams("$fetch",s,o),i=new U(s.methodConf.http),c=$.getMethod("$fetch",s,"get"),l=i[c](u),this.onRequest(r),t.prev=9,t.t0=this,t.t1=r,t.t2=s,t.next=15,l;case 15:return t.t3=t.sent,t.next=18,t.t0.onSuccess.call(t.t0,t.t1,t.t2,t.t3);case 18:t.next=23;break;case 20:t.prev=20,t.t4=t.catch(9),this.onError(r,t.t4);case 23:return t.abrupt("return",l);case 24:case"end":return t.stop()}}),t,this,[[9,20]])}))),function(t){return n.apply(this,arguments)})},{key:"onRequest",value:function(t){t("onRequest")}},{key:"onSuccess",value:function(t,e,n){return t("onSuccess"),e.insertOrUpdate({data:n})}},{key:"onError",value:function(t,e){t("onError",e)}}]),e}($),T=function(t){function e(){return o()(this,e),R()(this,j()(e).apply(this,arguments))}var n;return O()(e,t),s()(e,null,[{key:"call",value:(n=S()(q.a.mark((function t(e){var n,r,o,a,s,u,i,c,l,p=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,r=e.commit,o=p.length>1&&void 0!==p[1]?p[1]:{},a=y.getInstance(),s=a.getModelFromState(n),u=$.transformParams("$get",s,o),i=new U(s.methodConf.http),c=$.getMethod("$get",s,"get"),l=i[c](u),this.onRequest(r),t.prev=9,t.t0=this,t.t1=r,t.t2=s,t.next=15,l;case 15:return t.t3=t.sent,t.next=18,t.t0.onSuccess.call(t.t0,t.t1,t.t2,t.t3);case 18:t.next=23;break;case 20:t.prev=20,t.t4=t.catch(9),this.onError(r,t.t4);case 23:return t.abrupt("return",l);case 24:case"end":return t.stop()}}),t,this,[[9,20]])}))),function(t){return n.apply(this,arguments)})},{key:"onRequest",value:function(t){t("onRequest")}},{key:"onSuccess",value:function(t,e,n){return t("onSuccess"),e.insertOrUpdate({data:n})}},{key:"onError",value:function(t,e){t("onError",e)}}]),e}($),_=n(9),D=n.n(_),G=function(t){function e(){return o()(this,e),R()(this,j()(e).apply(this,arguments))}var n;return O()(e,t),s()(e,null,[{key:"call",value:(n=S()(q.a.mark((function t(e){var n,r,o,a,s,u,i,c,l,p=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state,r=e.commit,(o=p.length>1&&void 0!==p[1]?p[1]:{}).data&&"object"===D()(o)){t.next=4;break}throw new TypeError("You must include a data object in the params to send a POST request",o);case 4:return a=y.getInstance(),s=a.getModelFromState(n),u=$.transformParams("$create",s,o),i=new U(s.methodConf.http),c=$.getMethod("$create",s,"post"),l=i[c](u,o.data),this.onRequest(r),t.prev=11,t.t0=this,t.t1=r,t.t2=s,t.next=17,l;case 17:return t.t3=t.sent,t.next=20,t.t0.onSuccess.call(t.t0,t.t1,t.t2,t.t3);case 20:t.next=25;break;case 22:t.prev=22,t.t4=t.catch(11),this.onError(r,t.t4);case 25:return t.abrupt("return",l);case 26:case"end":return t.stop()}}),t,this,[[11,22]])}))),function(t){return n.apply(this,arguments)})},{key:"onRequest",value:function(t){t("onRequest")}},{key:"onSuccess",value:function(t,e,n){return t("onSuccess"),e.insertOrUpdate({data:n})}},{key:"onError",value:function(t,e){t("onError",e)}}]),e}($),z=function(t){function e(){return o()(this,e),R()(this,j()(e).apply(this,arguments))}var n;return O()(e,t),s()(e,null,[{key:"call",value:(n=S()(q.a.mark((function t(e){var n,r,o,a,s,u,i,c,l=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state,e.commit,(r=l.length>1&&void 0!==l[1]?l[1]:{}).data&&"object"===D()(r)){t.next=4;break}throw new TypeError("You must include a data object in the params to send a POST request",r);case 4:return o=y.getInstance(),a=o.getModelFromState(n),s=$.transformParams("$update",a,r),u=new U(a.methodConf.http),i=$.getMethod("$update",a,"put"),c=u[i](s,r.data),t.next=12,this.onRequest(a,r);case 12:return t.prev=12,t.t0=this,t.t1=a,t.t2=r,t.next=18,c;case 18:return t.t3=t.sent,t.next=21,t.t0.onSuccess.call(t.t0,t.t1,t.t2,t.t3);case 21:t.next=27;break;case 23:return t.prev=23,t.t4=t.catch(12),t.next=27,this.onError(a,r,t.t4);case 27:return t.abrupt("return",c);case 28:case"end":return t.stop()}}),t,this,[[12,23]])}))),function(t){return n.apply(this,arguments)})},{key:"onRequest",value:function(t,e){return t.update({where:e.params.id,data:{$isUpdating:!0,$updateErrors:[]}})}},{key:"onSuccess",value:function(t,e,n){return t.update({where:e.params.id||n.id,data:l()({},n,{$isUpdating:!1,$updateErrors:[]})})}},{key:"onError",value:function(t,e,n){return t.update({where:e.params.id,data:{$isUpdating:!1,$updateErrors:n}})}}]),e}($),N=function(t){function e(){return o()(this,e),R()(this,j()(e).apply(this,arguments))}var n;return O()(e,t),s()(e,null,[{key:"call",value:(n=S()(q.a.mark((function t(e){var n,r,o,a,s,u,i,c,l=arguments;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,e.commit,r=l.length>1&&void 0!==l[1]?l[1]:{},o=y.getInstance(),a=o.getModelFromState(n),s=$.transformParams("$delete",a,r),u=new U(a.methodConf.http),i=$.getMethod("$delete",a,"delete"),c=u[i](s),t.next=10,this.onRequest(a,r);case 10:return t.prev=10,t.t0=this,t.t1=a,t.t2=r,t.next=16,c;case 16:return t.t3=t.sent,t.next=19,t.t0.onSuccess.call(t.t0,t.t1,t.t2,t.t3);case 19:t.next=25;break;case 21:return t.prev=21,t.t4=t.catch(10),t.next=25,this.onError(a,r,t.t4);case 25:return t.abrupt("return",c);case 26:case"end":return t.stop()}}),t,this,[[10,21]])}))),function(t){return n.apply(this,arguments)})},{key:"onRequest",value:function(t,e){return t.update({where:e.params.id,data:{$isDeleting:!0,$deleteErrors:[]}})}},{key:"onSuccess",value:function(t,e,n){return t.delete({where:e.params.id||n.id})}},{key:"onError",value:function(t,e,n){return t.update({where:e.params.id,data:{$isDeleting:!1,$deleteErrors:n}})}}]),e}($),V=function(){function t(e,n){o()(this,t),y.setup(e,n),this.setupActions(),this.setupModels()}return s()(t,[{key:"setupActions",value:function(){var t=y.getInstance();t.components.Actions.$fetch=I.call.bind(I),t.components.Actions.$get=T.call.bind(T),t.components.Actions.$create=G.call.bind(G),t.components.Actions.$update=z.call.bind(z),t.components.Actions.$delete=N.call.bind(N)}},{key:"setupModels",value:function(){var t=y.getInstance();i()(t.database.entities,(function(t){return t.module=$.transformModule(t.module),t.model=$.transformModel(t.model),t})),t.components.Model.$fetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$fetch",t)},t.components.Model.$get=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$get",t)},t.components.Model.$create=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$create",t)},t.components.Model.$update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$update",t)},t.components.Model.$delete=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dispatch("$delete",t)}}}]),t}();n.d(e,"default",(function(){return Y}));var Y=function(){function t(){o()(this,t)}return s()(t,null,[{key:"install",value:function(t,e){return new V(t,e)}}]),t}()}])}));